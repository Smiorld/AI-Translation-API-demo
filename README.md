# AI-Translation-API-demo
A lightweight RESTful API for translating text into a specified language, built with Flask, SQLAlchemy, and a background AI translation module.
This project is mainly for personal learning and demonstration purposes, showcasing REST API design, APSheducler task handling and sqlite database management.
Following screenshot is the front-end demo powered by Tailwind for this project, which can be accessed through visiting the defaul "/" page.
<img width="1104" height="1347" alt="image" src="https://github.com/user-attachments/assets/dd6a2e76-bea4-4697-af5e-405478dc0601" />


# How to install & run
This project is developed under python 3.11.11, haven't test other version.
Clone this project and set up your virtual enviroment (recommended) before running following code.
Fill in your api-key and your specialized token in .env file. For testing purpose you can leave token as default value.

**.env**
```
OPENAI_API_KEY=sk-something
API_TOKEN=your_secret_token
DATABASE_URL=sqlite:///translations.db
```

Then run
```
pip install -r requirements.txt
python -m app.py
```

## API Endpoints Overview

### **1. Service Status API**
**Endpoint:** `GET /status`  
**Purpose:** Check the health of the entire LinguaFlow backend service, including database and background schedulers.

#### Example Request:
```bash
curl http://localhost:5001/status
```

#### Example Response:
```json
{
  "service": "ok",
  "database": "ok",
  "tasks": {
    "translate_job": "next_run: 2025-11-11 13:00:00",
    "crawler_job": "next_run: 2025-11-11 13:05:00"
  }
}
```

#### Response Details:
| Key | Description |
|-----|--------------|
| `service` | Overall service availability. Always `"ok"` if the API is responsive. |
| `database` | `"ok"` if the database connection succeeds, or an error message otherwise. |
| `tasks` | Shows all active scheduler jobs and their next run time. If scheduler is not configured, returns `"not configured"`. |

---

### **2. Translation API**
**Endpoint:** `POST /api/translate`  
**Authorization:** Requires Bearer token (`Authorization: Bearer <API_TOKEN>`)  

**Purpose:** Submit a piece of text to be translated and proofread using the AI translation service.  

#### Example Request:
```bash
curl -X POST http://localhost:5001/api/translate \
-H "Content-Type: application/json" \
-H "Authorization: Bearer mytoken123" \
-d '{"text": "你好世界", "target": "English"}'
```

#### Example Response:
```json
{
  "detected": "auto",
  "translated": "Hello, world",
  "proofread": "Hello world!"
}
```

#### Response Details:
| Key | Description |
|-----|--------------|
| `detected` | Automatically detected source language (placeholder `"auto"` for now). |
| `translated` | Raw translation generated by the AI model. |
| `proofread` | Grammar-checked and refined version of the translation. |

#### Notes:
- The translated result is automatically **stored in the database** (table: `Translation`).
- The `target` field defaults to `"English"` if not specified.

---

### **3. Translation Scheduler API**
**Blueprint:** `/translation_scheduler`  
These endpoints manage the background translation scheduler that periodically executes queued translation tasks.

---

#### **(a) Configure Scheduler Interval**
**Endpoint:** `POST /translation_scheduler/config`  
**Authorization:** Bearer token required.

#### Example Request:
```bash
curl -X POST http://localhost:5001/translation_scheduler/config \
-H "Authorization: Bearer mytoken123" \
-H "Content-Type: application/json" \
-d '{"interval": 15}'
```

#### Example Response:
```json
{
  "status": "ok",
  "interval": 15
}
```

#### Function:
- Removes any existing scheduled translation job.
- Creates a new job (`translate_job`) that runs every *N* minutes.
- The task executed is `execute_translation_tasks()` defined in `scheduler_service.py`.

---

#### **(b) Run Translation Tasks Immediately**
**Endpoint:** `POST /translation_scheduler/run_now`  
**Authorization:** Bearer token required.

#### Example Request:
```bash
curl -X POST http://localhost:5001/translation_scheduler/run_now \
-H "Authorization: Bearer mytoken123"
```

#### Example Response:
```json
{
  "status": "ok",
  "message": "execute translation task successfully"
}
```

#### Function:
- Executes all pending translation tasks immediately, without waiting for the next scheduled run.

---

### Authentication

All administrative and translation endpoints use simple token-based authentication.  
Add this header to your requests:
```bash
Authorization: Bearer <API_TOKEN>
```
The token is configured either in `.env` or Flask `config.py` as `API_TOKEN`.
